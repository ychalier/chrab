<!DOCTYPE html>

<html>

<head>
  <title>create</title>
</head>

<body>
  <h1>chrab</h1>
  <h2>register a user</h2>
  <form id="form-register">
    <input type="text" name="login" placeholder="login" />
    <input type="password" name="passwd" placeholder="password" />
    <button id="form-register-submit">submit</button>
  </form>

  <script>

  document.getElementById('form-register-submit').addEventListener('click',
  function(event) {
    event.preventDefault();
    let loginInput = document.querySelector(
      '#form-register > input[type="text"]');
    let passwordInput = document.querySelector(
      '#form-register > input[type="password"]');
    let credentials = JSON.stringify({
      'login': loginInput.value,
      'passwd': passwordInput.value
    });
    loginInput.value = "";
    passwordInput.value = "";
    let xhttp = new XMLHttpRequest();
    xhttp.open('POST', '/register', true);
    xhttp.onreadystatechange = function() {
      if (xhttp.readyState == 4) {
        if (xhttp.status == 201) {
          alert('Successfully registered!');
        } else {
          alert(xhttp.status + '\n' + xhttp.responseText);
        }
      }
    }
    xhttp.send(credentials);
  });

  </script>

</body>

</html>
